(function(e){function t(e){return e.text||nt(e)}function n(e){return e.pos||rt(e)}function r(e){return t(e).substring(0,n(e))}function i(e){return t(e).substring(n(e))}function s(e){return t(e).substring(0,F(e))}function o(e){return t(e).substring(I(e))}function u(e){return G(t(e))}function a(e){return u(e).length}function f(e){return G(r(e))}function l(e){return G(i(e))}function c(e){return f(e).allButLast()}function h(e){return l(e).allButFirst()}function p(e){return e.text=e.text||t(e),G(t(e))[d(e)]}function d(e){return c(e).length}function v(e){return f(e).last()}function m(e){return l(e).first()}function g(e){return v(e).length}function y(e){return m(e).length}function b(e){return e.pos=e.pos||n(e),n-g(e)}function w(e){return e.pos=e.pos||n(e),n+y(e)}function E(e){return Y(p(e))}function S(e){return E(e).length}function x(e){return Y(v(e))}function T(e){return Y(m(e))}function N(e){return x(e).allButLast()}function C(e){return T(e).allButFirst()}function k(e){return Y(t(e))}function L(e){return k(e).length}function A(e){return Y(r(e))}function O(e){return Y(i(e))}function M(e){return A(e).allButLast()}function _(e){return O(e).allButFirst()}function D(e){return e.text=e.text||t(e),e.pos=e.pos||n(e),P(e)+H(e)}function P(e){return x(e).last()}function H(e){return T(e).first()}function B(e){return P(e).length}function j(e){return H(e).length}function F(e){return e.pos=e.pos||n(e),e.pos-B(e)}function I(e){return e.pos=e.pos||n(e),e.pos+j(e)}function q(e){return e.pos=e.pos||n(e),g(e)-B(e)}function R(e){return e.pos=e.pos||n(e),g(e)+j(e)}function U(e,t){var n=t==="lineEnd"?n(e):v(e);if(!n||t==="lineStart")return 0;B(e)===0?t="wordStart":t==="wordStart"&&(n=n.slice(0,-B(e))),t==="wordEnd"&&(n+=H(e));var r=ut(e,!1),i=lt(e),s=/\W+/g,o=n.split(s),u=n.match(s),a=0;n="";do D=o[a],s=u&&u[a]||"",t||(D+=o[a]===o.last()?H(e):""),length=ft(n+=D+s,r),length>i&&(a--,n="");while(o[++a]);return t||(length=ft(n.replace(D,o.last()),r)),length}function z(e){return at(r(e),ut(e,!0))}function W(e,t){return{x:U(e,t),y:z(e)}}function X(e){return W(e,"lineStart")}function V(e){return W(e,"lineEnd")}function $(e){return W(e,"wordStart")}function J(e){return W(e,"wordEnd")}function K(e,t){e.value=r(e)+t+i(e)}function Q(e,t){e.value=s(e)+t+o(e)}function G(e){return e.split("\n")}function Y(e){return e.split(/\W+/)}function et(e){return e=e.jquery?e.get(0):e,e&&e instanceof HTMLElement&&e.nodeName.toLowerCase()==="textarea"?e:null}function tt(e){return parseInt(window.getComputedStyle(e,null).getPropertyValue("line-height"))}function nt(e){return e.value}function rt(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange(),r=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t=n.text.length-r}else if(e.selectionStart||e.selectionStart=="0")t=e.selectionStart;return t}function it(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}function st(e){var t=this.textarea;t.select(),t.mouseup(function(){return t.unbind("mouseup"),!1})}function ot(e){return document.selection?document.selection.getRange().text.length>0:e.selectionStart!==e.selectionEnd}function ut(e,t){var n;return(n=document.getElementById("gami-copy"))||(n=document.createElement("div"),n.setAttribute("id","gami-copy"),n.style.visibility="hidden",n.style.font=window.getComputedStyle(e,null).getPropertyValue("font"),e.parentNode.appendChild(n)),n.style.width=t?lt(e)+"px":"auto",n.style.display=t?"block":"inline-block",n}function at(e,t){return e=e.replace(/\n/g,"<br>").replace(/^\W*<br>/,".<br>").replace(/<br>\W*<br>/g,"<br>.<br>").replace(/<br>\W*$/,"<br>."),t.innerHTML=e||".",t.offsetHeight}function ft(e,t){return t.innerHTML=e.replace(/ /g,"&nbsp;"),lt(t)}function lt(e){return e.offsetWidth}Array.prototype.first=function(){return this[0]},Array.prototype.last=function(){return this[this.length-1]},Array.prototype.allButFirst=function(){return this.slice(1)},Array.prototype.allButLast=function(){return this.slice(0,-1)};if(e){var Z={text:t,pos:n,before:r,after:i,lines:u,numLines:a,beforeLines:f,afterLines:l,linesBefore:c,linesAfter:h,line:p,lineNum:d,lineBefore:v,lineAfter:m,linePos:g,lineDist:y,lineStart:b,lineEnd:w,words:E,numWords:S,beforeWords:x,afterWords:T,wordsBefore:N,wordsAfter:C,allWords:k,wordCount:L,allBeforeWords:A,allAfterWords:O,allWordsBefore:M,allWordsAfter:_,word:D,wordBefore:P,wordAfter:H,wordPos:B,wordDist:j,wordStart:F,wordEnd:I,lineWordStart:q,lineWordEnd:R,X:U,Y:z,XY:W,lineXY:X,lineEndXY:V,wordXY:$,wordEndXY:J,insert:K,replaceWord:Q};e.fn.gami=function(){var e=et(this),t=Z[arguments[0]];if(e&&t){var r,i=[e],s,o=1;while(s=arguments[o++])typeof s=="number"?r=s:i.push(s);return e.text=e.pos=null,r&&(e.pos=n(e)+r),t.apply(this,i)}}}})(window.jQuery);